<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>US Presidential Election Countdown</title>
  <style>
    body {
      font-family: sans-serif;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      height: 100vh;
      margin: 0;
      padding: 0;
      position: relative; /* To position the flag image */
    }

    h1 {
      margin-bottom: 20px;
      text-align: center;
      background-size: 100%;
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-image: linear-gradient(to right, rgb(230, 0, 0), rgb(255, 255, 255), rgb(0, 0, 255)); /* US Flag colors */
    }

    #countdown {
      font-size: 2rem;
      margin-bottom: 20px;
      padding: 10px;
      border-radius: 5px;
      background-color: white; /* Default white */
      color: black; /* Default black text */
      text-align: center;
    }

    body::before {
      content: "";
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background-image: url("https://www.pngkey.com/png/full/11-113802_united-states-flag-png-transparent-background-united-states.png"); /* Replace with your flag image URL */
      background-size: 10%; /* Adjust the size as needed */
      background-repeat: no-repeat;
      background-position: center;
      opacity: 0; /* Default opacity */
      pointer-events: none; /* Make the flag image non-interactive */
      transition: opacity 0.5s ease; /* Smooth transition for opacity */
    }
  </style>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.29.4/moment.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/moment-timezone/0.5.36/moment-timezone-with-data.min.js"></script>
</head>
<body>
  <h1>US Presidential Election Countdown</h1>
  <div id="countdown">...</div>

  <script>
    const countdownElement = document.getElementById('countdown');
    const flagWatermark = document.querySelector('body::before'); // Get the flag watermark element
    const h1Element = document.querySelector('h1'); // Get the h1 element

    // Election date in New York Timezone (EST)
    const electionDate = moment.tz('November 5, 2024 00:00:00', 'America/New_York').toDate();

    // US Flag Red Color (RGB)
    const flagRed = [230, 0, 0]; // Approximate US flag red

    // Function to update the countdown
    function updateCountdown() {
      const now = moment.tz(); // Get the current time in the user's timezone
      const timeDifference = electionDate - now.toDate();

      const days = Math.floor(timeDifference / (1000 * 60 * 60 * 24));
      const hours = Math.floor((timeDifference % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
      const minutes = Math.floor((timeDifference % (1000 * 60 * 60)) / (1000 * 60));
      const seconds = Math.floor((timeDifference % (1000 * 60)) / 1000);

      // Build the countdown string, only including non-zero values
      let countdownString = '';
      if (days > 0) {
        countdownString += `${days}d `;
      }
      if (hours > 0) {
        countdownString += `${hours}h `;
      }
      if (minutes > 0) {
        countdownString += `${minutes}m `;
      }
      countdownString += `${seconds}s`;

      countdownElement.textContent = countdownString;

      // Update background color smoothly
      const timeRemainingPercentage = (timeDifference / (1000 * 60 * 60 * 24 * 30)) * 100; // Assuming 30 days max

      // Animate the background color change
      function animateBackgroundColor() {
        const redIntensity = Math.max(0, 100 - timeRemainingPercentage); // Calculate redIntensity for each frame
        if (redIntensity > 0) {
          // Interpolate between white and flag red
          const interpolatedRed = flagRed.map((flagVal, i) => {
            return Math.round(flagVal * (redIntensity / 100));
          });
          countdownElement.style.backgroundColor = `rgb(${interpolatedRed[0]}, ${interpolatedRed[1]}, ${interpolatedRed[2]})`;
          requestAnimationFrame(animateBackgroundColor); // Request the next frame for animation
        } else {
          // Stop animation when redIntensity reaches 0
        }
      }

      // Start the animation
      requestAnimationFrame(animateBackgroundColor);

      // Update text color and flag opacity
      if (redIntensity > 50) {
        countdownElement.style.color = 'white';
        flagWatermark.style.opacity = 1; // Flag fully visible when redIntensity is high
      } else {
        countdownElement.style.color = 'black';
        flagWatermark.style.opacity = redIntensity / 100; // Flag fades out as redIntensity decreases
      }
    }

    // Initialize the countdown
    updateCountdown();
    const countdownInterval = setInterval(updateCountdown, 1000);
  </script>
</body>
</html>
